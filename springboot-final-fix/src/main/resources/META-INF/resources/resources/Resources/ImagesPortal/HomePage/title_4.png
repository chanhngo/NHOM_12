.initScopePrefixes(u._config,function(n){return u.getLocString(n)},function(n){return u.getEnUsLocString(n)})}),typeof ConnectedAccounts!="undefined"&&t.Promise.safeChain("initConnectedAccount",function(){return ConnectedAccounts.init()},function(){n.isDataSourceEnabled(t.DataSources.SubstrateSuggestionsEnterprise,null,u._config)&&t.Promise.safeChain("getConnectedAccount_SubstrateEnterprise",function(){return ConnectedAccounts.getConnectedAccount(t.Office365Provider,t.SubstrateResourceUrl,!1,1440)},function(n){var i=!!n&&n.Connected;i!=t.isSubstrateO365AccountConnected&&(t.isSubstrateO365AccountConnected=i,t.initScopePrefixes(u._config,function(n){return u.getLocString(n)},function(n){return u.getEnUsLocString(n)}))});n.isDataSourceEnabled(t.DataSources.SubstrateSuggestionsConsumer,null,u._config)&&t.Promise.safeChain("getConnectedAccount_SubstrateConsumer",function(){return ConnectedAccounts.getConnectedAccount(t.OutlookProvider,t.SubstrateResourceUrl,!1,1440)},function(n){var i=!!n&&n.Connected;i!=i&&(i=i,t.initScopePrefixes(u._config,function(n){return u.getLocString(n)},function(n){return u.getEnUsLocString(n)}))})}),ThresholdUtilities.getThemeColor(function(n){n!=u._accentColor&&(u._accentColor=n,u.applyAccentColor(n))}),ThresholdUtilities.setBodyLangAttributes(i.uiLanguage),l=this.getFeatureEnabled(t.SearchBoxOnTopFeatureName).featureEnabled,l!=this._searchBoxOnTop&&(this._searchBoxOnTop=l,l?this._qfContainer.classList.add(h):this._qfContainer.classList.remove(h)))},a.prototype.getAccentColor=function(){return this._accentColor},a.prototype.applyAccentColor=function(t){var u,f="accent-style",r=_ge(f),i;r||(r=_d.createElement("style"),r.setAttribute("id",f),r.type="text/css",u=!0);i=".icon svg { fill: {0} } .gridLayout .suggestion.sa_hv, .gridLayout .suggestion.sa_hv:hover { border-color: {1}; }";n.isHighContrastEnabled()||(i+=".action, .accentColor, .groupAnnotations { color: {0}; } .sa_hv, .sa_hv:hover, .sa_hv.selectable:active { background-color: {1}; }",i+=".topHitConnectedToGroup:not(.sa_hv) { background: {2}; }",i+="#root .selectedScope { background-color: {3}; }",i+="#root .selectedScope:hover { background-color: {4}; }",i+="#root .selectedScope:active { background-color: {5}; }",i+="#startMenu .icon { background-color: {5}; }");r.innerHTML=n.formatString(i,[t,o(t,.3),o(t,.1),o(t,.4),o(t,.6),o(t,.7)]);u&&_d.head.appendChild(r)},a.prototype.createGuid=function(){return n.safeExecute(function(){return i.createGuid()},"createGuid","")},a.prototype.getLocString=function(t){for(var i,u=[],r=1;r<arguments.length;r++)u[r-1]=arguments[r];return i=this._locStrings?this._locStrings[t]:this._enUsLocStrings[t],i&&u.length>0&&(i=n.formatString(i,u)),i},a.prototype.getEnUsLocString=function(n){return this._enUsLocStrings[n]},a.prototype.getImpressionGuid=function(){return n.cleanGuid(this._currentRawImpressionId)},a.prototype.getConversationId=function(){return this._currentCVID},a.prototype.getPrivacyNumber=function(){return this._randomPrivacyNumber},a.prototype.getNewConversationId=function(){var t=n.cleanGuid(n.safeExecute(function(){return e.perfMetrics.conversationId},"conversationId"));return t||(SharedLogHelper.LogWarning("getNewConversationId",null,new Error("Client returned null conversation ID")),t=n.cleanGuid(this.createGuid())),t},a.prototype.getNewPrivacyNumber=function(){return Math.floor(Math.random()*Number.MAX_VALUE)},a.prototype.bindQueryChangedOrInitialized=function(n){this._queryChangedHandlers.push(n)},a.prototype.bindCursorPositionUpdated=function(n){this._cursorPositionChangedHandlers.push(n)},a.prototype.bindOnSubmit=function(n){this._onSubmitHandlers.push(n)},a.prototype.bindSearchBoxGotFocus=function(n){this._searchBoxGotFocusEventHandlers.push(n)},a.prototype.bindSearchBoxLostFocus=function(n){this._searchBoxLostFocusEventHandlers.push(n)},a.prototype.getModifierKeyState=function(){return this._modifierKeyState},a.prototype.bindAppVisible=function(n){this._appVisibleEventHandlers.push(n)},a.prototype.bindShown=function(n){this._shownEventHandlers.push(n)},a.prototype.bindConversationStart=function(n){this._conversationStartEventHandlers.push(n)},a.prototype.bindDismissed=function(n){this._dismissedEventHandlers.push(n)},a.prototype.bindAppHidden=function(n){this._appHiddenEventHandlers.push(n)},a.prototype.bindKeyDown=function(n){this._keyDownHandlers.push(n)},a.prototype.bindKeyUp=function(n){this._keyUpHandlers.push(n)},a.prototype.getQuery=function(){return this.getStructuredQuery(u.getQueryText(),this._previousQuery)},a.prototype.setQuery=function(t,r,f){var o=this,e=this._currentQuery?this._currentQuery.originalQuery:null;t=t||r?t:e;r||f||!t||t==e||(this._queriesToIgnoreOnQueryTextChan